# 파일 시스템 
~~~
<키워드>
1. 파일
2. 디렉터리
3. 파이셔닝
4. 파일 할당 방법
5. FAT 파일 시스템, 유닉스 파일 시스템
~~~

# 파일과 디렉터리
- 파일과 디렉터리는 보조장치에 있는 데이터 덩어리이지만, 운영체제의 파일 시스템은 이를 파일과 디렉터리로 나누어 관리한다.

## 파일
- 하드 디스크나 SSD와 같은 보조기억장치에 저장된 관련 정보의 집합
- 의미 있고 관련 있는 정보를 모은 논리적 단위
- 파일을 실행하기 위한 부가정보로는 '속성'과 '메타데이터'가 있습니다.

### 파일 속성과 유형
- 파일 유형 : 운영체제가 인식하는 파일 종류
    - 같은 이름의 파일일지라도 텍스트 파일, 실행 파일, 음악 파일 등 유형이 다르면 실행 양상도 달라진다.
- 파일 유형을 알리기 위해 흔시 사용하는 방식은 '확장자'를 사용하는 것이다.
    - 확장자는 파일 동류가 무엇인지 운영체제에 알려주는 힌트와도 같다.

### 파일 연산을 위한 시스템 호출
- 파일을 다루는 모든 작업은 무조건 운영체제에 의해 이루어 진다.
- 이를 위해 운영체제는 다음과 같은 연산을 위한 시스템 호출을 제공한다.
- (1)파일 생성, (2)삭제, (3)열기, (4)닫기, (5)읽기, (6)쓰기

## 디렉터리 
- 파일을 일목요연하게 관리하는 것이 '디렉터리'
    - 윈도우 운영체제에선 디렉터리를 폴더리고 부른다.

### 트리구조 디렉터리
- 트리구조 디렉터리는 최상위 디렉터리가 있고 그 아래에 서브 디렉터리가 있다.
- 최상위 디렉터리는 흔히 루트 디렉터리라고 부르고 슬래시로 표현한다.

### 절때 경로와 상대 경로
- '경로'는 디렉터리를 이용해 파일 위치, 나아가 파일 이름을 특정 짓는 정보이다.
- 모든 파일은 루트 디렉토리에 자기 자신까지 이르는 고유한 경로를 가지고 있고, 이러한 경로를 '절대 경로'라고 부른다.
- '상대 경로'란 현재 디렉토리부터 시작하는 경로

### 디렉터리 엔트리(행)
- 파일은 내부에 (해당파일, 관련된 정보)를 담고 있고
- 디렉토리는 내부에 (해당 디렉토리에 담겨있는 대상, 관련된 정보)를 담고있습니다.
- 디렉토리는 보조기억 장치에 테이블 형태의 정보로 저장 됩니다.
- 각각의 엔트리에 담기는 정보는 차이가 있지만 

## 파일 시스템
- '파일 시스템'은 학습한 파일과 디렉터리를 보조기억장치에 일목요연하게 저장하고 접근할 수 있게 하는 운영체제 내부 프로그램이다.
- 이러한 파일 시스템에는 다양한 종류가 있고, 하나의 컴퓨터에서 여러 파일 시스템을 사용할 수 있다.
- 대표적으로 (1)FAT 파일 시스템, (2)유닉스 파일 시스템 이 있다.

### 파티셔닝과 포매팅
- 보조기억 장치를 사용하려면 '파티셔닝'과 '포매팅'을 거쳐야 한다.
- 파티셔닝 : 저장 장치의 논리적인 영역을 구획하는 작업이다.
    - 하드디스크나 SSD 처럼 용량이 큰 저장장치를 하나 이상의 논리적 단위로 구획
    - 이러한 파니셔닝 작업을 통해 나누어진 영역을 '파티션'이라고 한다.
- 포매팅(논리적 포매팅) : 파일 시스템을 설정하여 어떤 방식으로 파일을 저장하고 관리할 것인지를 결정하고, 새로운 데이터를 쓸 준비를 하는 작업을 의미한다.
    - 즉, 포매팅 할 때 파일 시스템이 결정된다.
- 파티셔닝과 포매팅은 동시에 진행되는 경우가 많음!

## 파일 할당 방법
- 하드 디스크 포매팅이 끝나고 사용할 파일을 저장할 때, 운영체제는 파일과 디렉터리를 블록 단위로 읽고 쓴다.
- 하나의 파일이 보조기억장치에 저장될 때는 하나 이상의 블록에 걸쳐 저장된다.
    - 운영체제는 하나 이상의 섹터를 블록이라는 단위로 묶은 뒤 블록 단위로 파일과 디렉터리를 관리한다.

#### 연속 할당과 불연속 할당
- 파일을 보조기억장치에 할당하는 방법 2가지

### 연속할당
- 가장 단순한 방식으로 보조기억장치 내 연속적인 블록에 파일을 할당하는 방식
- (+) 구현이 단순하다는 장점이 있지만
- (-) 외부단편화를 야기한다는 문제가 있다.

### 연결할당
- 연속 할당의 문제를 해결할 수 있는 방식
- 파일을 이루는 데이터를 연결 리스트로 관리한다.
- 연결 할당은 불연속 할당의 일종이기에 파일이 여러 블록에 흩어져 저장되어도 무방하다.
- 연결 할당을 사용하는 파일 시스템에서는 디렉터리 엔트리에 연속할당과 마찬가지로 파일 이름과 함께 첫 번째 블록 주소와 블록단위 길이를 명시한다.
- (-) 반드시 첫 번째 블록부터 하나씩 차례로 읽어야 한다.
- (-) 하드웨어 고장이나 오류 발생 시 해당 블록 이후 블록은 접근할 수 없다.

### 색인 할당
- 색인 할당은(indexed allocation)은 파일의 모든 블록 주소를 색인 블록(index block)에 모아 관리하는 방식
- 색인 할당은 연결 할당과는 달리 파일 내 임의의 위치에 접근하기 쉽다.
- 파일의 i번째 데이터 블록에 접근하고 싶다면 색인 블록의 i번째 할목이 가리키는 블록에 접근하면 되기 떄문이다.
- 색인 할당을 사용하는 파일 시스템에서는 디렉터리 엔트리에 파일 이름과 더불어 색인 블록 주소를 명시한다

## 파일 시스템
1. FAT 파일 시스템 : USB, SD 카드 등의 저용량 저장장치에서 사용됨
2. 유닉스 파일 시스템 : 유닉스 운영체제에서 사용됨

### FAT 파일 시스템
- 블록 주소를 한데 모아 테이블 형태로 관리하는 것을 파일 할당 테이블(FAT) 이라고 한다.
    - 파일의 찻번째 블록 주소만 알면 파일의 데이터가 담긴 모든 블록에 접근할 수 있음
- FAT를 아용하는 파일 시스템이 FAT 파일 시스템이라고 한다.
- FAT 파일 시스템에서 FAT는 파티션의 앞 부분에 만들어 진다.
- FAT는 하드디스크 파티션의 시작 부분에 있지만, 실행 도중 FAT가 메모리에 캐시 될 수 있다.
- 그럼 FAT가 메모리에 캐시될 수 있습니다. FAT가 메모리에 적재된 채 실행되면 기존 연결 할당보다 다음 블록을 찾는 속도가 빨라지고, 결과적으로 앞서 설명한 연결 할당 방식보다 임의 접근에도 유리해 진다.
- 즉! FAT가 메모리에 적재된 채 실행되면 임의 접근의 성능이 개선된다.

### 유닉스 파일 시스템
- 색인 블록을 기반으로 파일의 데이터 블록들을 찾는 방식
- 유닉스 파일 시스템에서는 이러한 색인 블록을 **i-node**라고 한다.

#### i-node
- i-node에는 15개의 블록 주소가 저장 될 수 있다.
- i-node 주소는 유한하기 때문에 파일의 모든 데이터 블록을 가리킬 수 없다.

#### 유닉스 파일 문제점 해결 방법
1. 1~12 : 블록 주소 중 열두 개에는 직접 블록 주소를 저장한다.
2. 13 : (1)으로 충분하지 않다면 열세번째 주소에 단일 간접 주소 블록을 저장한다.
    - 파일 데이터가 저장된 블록이 아닌 파일 데이터를 저장한 블록 주소가 저장된 블록을 의미한다.
3. 14 : (2)으로 충분하지 않다면 열네번째 주송 이중 간접 블록 주소를 저장한다.
    - '이중 간접 블록'이란 데이터 블록 주소를 저장하는 블록주소가 저장된 블록의 의미한다.
4. 15 : (3)으로 충분하지 않다면 열다섯번째 주소에 삼중 간접 블록 주소를 저장한다.
    - 삼중 간접 블록이란 이중 간접 블록 주소가 저장된 블록이다.
- 이로써 i-node만 알면 파일 속성 뿐만 아니라 파일 크기가 크더라도 파일 데이터를 모두 가리킬 수 있다.

### 저널링 파일 시스템
- 시스템 크레시가 발생했을 경우 저널링 기법을 사용하여 작업 로그를 통해 빠르게 복구할 수 있다.
    - '시스템 크래시'란 치명적인 오류로 인해 컴퓨터가 강제로 종료되는것을 말한다.
- '저널링 기법'이란 작업 로그를 통해 시스템 크래시가 발생했을 때 빠르게 복구하기 위한 방법이다.
1. 작업 직접 파이션의 로그 영역에 수행하는 작업에 대한 로그를 남긴다.
2. 로그를 남긴 후 작업을 수행한다.
3. 작업이 끝났다면 로그를 삭제한다.

### 마운트
- 한 저장장치의 파일 시스템에서 다른 저장 장치의 파일 시스템에 접근할 수 있도록 파일 시스템을 편입 시키는 작업을 '마운트'라고 한다.
