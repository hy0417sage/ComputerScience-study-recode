## 다양한 외부 장치가 컴퓨터 내부와 연결되고 소통할까요?
- 장치 컨트롤러
- 창지 드라이버
- 를 통해 컴퓨터 내 외부를 연결합니다.

## 입출력 장치가 CPU, 메모리 보다 다루기가 어려운 이유
1. 입출력장치의 종류가 많음 : 정보를 주고 받는 방식을 규격화 하기 어려움
2. CPU와 입출력 장치의 전송률이 낮음
    - '전송률'이란 데이터를 얼마나 빨리 교환할 수 있는지를 나타내는 지표
- 위와 같은 문제를 개선하기 위해 '장치 레지스터'를 사용함

## 장치 컨트롤러
- 입출력장치를 연결하는 **하드웨어적** 통로
### 장치 컨트롤러의 역할
1. CPU와 입출력 장치 간의 통신 중계
2. 오류 검출
3. 데이터 버퍼링 : 전송률이 높은 장치와 낮은 장치 사이에 주고 받는 데이터를 버퍼(임시 저장 공간)에 저장하여 전송률을 비슷하게 맞춤

### 장치 컨트롤러의 내부
- 데이터 레지스터 : CPU와 입출력장치 사이에 주고 받을 데이터가 담기는 레지스터
- 상태 레지스터 : (1)입출력 작업을 할 준비 (2)입출력 작업 완료 (3)입출력장치 오류 등의 상태 정보가 저장
- 제어 레지스터 : 입출력장치가 수행할 내용에 대한 제어 정보와 명령을 저장

# 장치 컨트롤러가 CPU와 정보를 주고 받는 방법
## 1. 프로그램 입출력 : 프로그램 속 명령어로 입출력장치를 제어하는 방법
- (실행과정)
1. 'CPU'에서 하드 디스크 컨트롤러의 제어 레지스터에 쓰기 명령을 보낸다.
2. '하드 디스크 컨트롤러'는 하드 디스크가 준비된 상태라면 상태 레지스터에 '준비완료' 표시를 한다.
3. 'CPU'는 상태 레지스터를 주기적으로 읽으며 하드 디스크 준비 여부를 확인한다.    
4. 'CPU'가 하드디스크 준비여부를 알게 되면 백업할 정보를 데이터 레지스터에 쓴다.

### CPU가 장치 컨트롤러 속 레지스터를 아는 방법
1. 메모리 맵 입출력
    - **메모리에 접근하기 위한 주소 공간**과 (512개)
    - **입출력 장치에 접근하기 위한 주소 공간**을 (512개)
    - 하나의 주소 공간으로 간주하는 방법 (1024개의 메모리주소)
    - 메모리 주소 공간이 축소됨
    - 메모리와 입출력 장치에 같은 명령어 사용
2. 고립형 입출력
    - **메모리를 위한 주소 공간**과 (512개)
    - **입출력 장치를 위한 주소 공간**을 (512개)
    - 분리하는 방법 (1024개의 메모리주소)
    - 메모리 주소 공간이 축소되지 않음
    - 입출력 전용 명령어 사용

## 2. 인터럽트 기반 입출력
- 장치 컨트롤러가 입출력 작업을 끝낸 뒤 CPU에게 인터럽트 요청 신호를 보내면 CPU가 하는 일을 잠시 백업하고 인터럽트 서비스 루틴 실행
- 인터럽트와 비교되는 개념 '폴링'
    - 입출력 장치의 상태는 어떤지, 처리할 데이터가 있는지 주기적으로 확인하는 방식
    - (-)인터럽트 방식보다 CPU의 부담이 큼 (주기적 확인)

### 여러 입출력 장치에서 인터럽트가 동시에 발생한 경우 처리방법
    - 인터럽트간의 우선순위를 고려하며 처리! : PIC로 사용
    - PIC; Programmable Interrupt Controller : 여러 장치 컨트롤러에 연결되어 장치 컨트롤러에서 보낸 하느뒈어 인터럽트 요청들의 우선순위를 판별한 뒤 CPU에 지금 처리해야할 하드웨어 인터럽트가 무엇인지 알려주는 창지

### PIC의 다중 인터럽트 처리 방법
1. 장치 컨트롤러 -> (PIC)인터럽트 요청 신호 받아드림
2. (PIC)인터럽트 우선순위 판단 -> CPU에 처리해야할 인터럽트 요청신호 보냄
3. (CPU) -> (PIC) 인터럽트 확인 신호 보냄
4. PIC는 데이터 버스를 통해 CPU에 인터럽트 벡터를 보냄
5. CPU 인터럽트 서비스 루틴을 실행

## DMA(;Direct Memory Access)
- 입출력장치와 메모리가 CPU를 거치지 않고도 직접 상호 작용할 수 있는 입출력 방식
- DMA 입출력을 하기 위해선 시스템 버스에 연결된 DMA 컨트롤러 하드웨어 필요

### DMA 등장 이유
- 프로그램 기반 입출력, 인터럽트 기반 입출력 둘다 입출력 장치와 메모리간의 데이터 이동은 CPU가 주도함
- (-) 위와 같은 방식은 CPU의 부담이 커짐 
- 그래서 등장한 방식이 DMA

### DMA 입출력 과정
1. CPU는 DMA 컨트롤러에 (1)입출력장치의 주소 (2)읽기/쓰기 연산 (3)읽고나 쓸 메모리 주소
2. DMA 컨트롤러는 CPU 대신 장치 컨트롤러와 상호작용 하며 입출력 작업 수행
    - DMA 컨트롤러는 필요한 경우 메모리에 직접 접근하여 정보를 읽거나 씀
3. 입출력 작업이 끝나면 DMA 컨트롤러는 CPU에 인터럽트를 걸어 작업이 끝났음을 알림
- (-) 시스템 버스는 공용 자원이기 때문에 동시 사용 불가능
- DMA 컨트롤러는 CPU가 시스템 버스를 이용하지 않을 때 조금씩 이용하거나 CPU가 일시적으로 시스템 버스를 이용하지 않도록 허락을 구하고 집중 이용
    - DMA의 시스템 버스 이용을 '사이클 스틸링'이라고 함


### 입출력 버스
- DMA를 위해 시스템 버스를 너무 자주 사용하면 그만큼 CPU가 시스템 버스를 이용하지 못함
    - 해결 : DMA 컨트롤러와 장치 컨트롤러들을 입출력 버스에 연결하여 해결 가능

## 장치 드라이버
- 입출력 장치를 연결하는 **소프트웨어작** 통로. '프로그램'
- 장치 컨트롤러의 동작을 감지하고 제어함으로써, 장치 컨트롤러가 컴퓨터 내부와 정보를 주고 받을 수 있게 하는 프로그램
- 컴퓨터가 연결된 장치의 드라이버를 인식하고 실행할 수 있다면 해당 입출력 장치의 사용이 가능하다.

