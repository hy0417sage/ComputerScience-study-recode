# TCP/IP 4계층 모델

## 💛 애플리케이션 계층
- 응용 프로그램이 사용되는 프로토콜 계층이며 웹 서비스, 이메일 등 서비스를 실질적으로 사람들에게 제공하는 층이다.
- FTP, SSH, HTTP, SMTP, DNS

<br>

## 💛 전송계층 (TCP/UDP)
- TCP는 패킷 사이의 순서를 보장하고 연결 지향 프로토콜 방식을 사용해서 연결을 하여 신뢰성을 구축해서 수신 여부를 확인하며 '가상회선 패킷 교환방식'을 사용한다.
- UDP는 순서를 보장하지 않고 수신 여부를 확인하지 않으며 단순히 뎅터만 주는 '데이터 그램 패킷 교환 방식'을 사용한다.

### 가상 회선 패킷 교환 방식 (TCP)
- 각 패킷에는 가상 회선 식별자가 포함되며 모든 패킷을 전송하면 가상 회선이 해제되고 패킷들은 전송된 순서대로 도착하는 방식
- 패킷 순서에 따라 순서대로 도착

### 데이터 그램 패킷 교환 방식 (UDP)
- 하나의 메시지에서 분할된 여러 패킷은 서로 다른 경로로 전송될 수 있으며 도착한 순서가 다를 수 있는 방식
- 순서대로 도착하지 않음

## 3-way handshake : TCP 연결 성립 과정
- TCP 3 way handshake 는 TCP/IP 프로토콜을 이용해서 통신을 하는 응용 프로그램이 데이터를 전송하기 전에 먼저 정확한 전송을 보장하기 위해 상대방 컴퓨터와 사전에 세션을 수립하는 과정을 의마한다.
- TCP 네트워크에서 통신을 하는 장치가 서로 연결이 잘 되어잇는지 확인하는 방법으로 송신자와 수신자는 총 3번에 걸쳐 데이터를 주고 받으며 가능한 상태임을 확인
- TCP는 신뢰성을 확보할 때 3-way handshake 작업을 진행한다.
1. SYN(클라이언트 -> 서버) : 클라이언트는 서버에 접속 요청하는 SYN 패킷을 보냄
2. SYN + ACK(서버 -> 클라이언트) : 서버는 클라이언트 요청인 SYN을 받고, 클라이언트에 요청을 수락한다는 ACK와 SYN이 설정된 패킷을 발송함
3. ACK(클라이언트 -> 서버) : 클라이언트가 서버 의 수락 응답인 패킷을 받고 ACK를 서버로 보내면 연결이 성립됨
- TCP는 이 과정이 있기 때문에 신뢰성 있는 계층이라고 불린다.

### 플래그
- SYN : 연결 요청 플래그
- ACK : 응답 플래그
- ISN : 초기 네트워크를 연결할 깨 할당된 32비트 고유 시퀀스 번호

## 4-way handshake : TCP 연결 해제 과정
1. FIN(클라이언트 -> 서버) : 클라이언트가 연결을 닫으려고 할 때 FIN으로 설정된 세그먼트를 보낸다.
2. ACK(서버 -> 클라이언트) : 서버는 클라이언트로 ACK를 보내고 일정 시간 이후에 클라이언트에 FIN이라는 세그먼트를 보낸다
3. FIN(서버 -> 클라이언트) : 서버는 ACK 를 보내고 일정 시간 이후에 FIN 세그먼트를 보낸다
4. ACK(클라이언트 -> 서버) : 클라이언드는 TIMA_WATE 상태가 되고 다시 서버로 ACK를 보내서 서버는 COLSED 상태가 됩니다. 이후 클라이언트는 어느 정도 시간을 대기할 후 연결이 닫히고 클라이언트와 서버의 모든 자원의 연결이 해제됩니다. 

### TIME_WATE
- 소켓이 바로 소멸되지 않고 일정 시간 유지되는 상태를 말하며 지연 패킷 등의 문제점을 해결하는 데 쓰인다.

### 데이터 무결성
- 데이터의 정확성과 일관성을 유지하고 보증하는 것

<br>

## 💛 인터넷 계층
- 장치로 부터 받은 네트워크 패킷을 IP 주소로 지정된 목적지로 전송하기 위해 사용하는 계층
- IP, ARP, ICMP
- 패킷을 수신해야할 상대의 주소를 지정하여 데이터를 전달
- 비 연결성 특징을 가지고 있다.

## 💛 링크 계층
- 실질적으로 데이터를 전달하며 장치간의 신호를 주고 받는 규칙을 사용하는 계층
- 전선, 광섬유, 무선


<br>

## 계층간의 데이터 송수신 과정
- HTTP를 통해 웹 서버에 있는 데이터를 요청한다면,
- 캡슐화, 비 캡슐화 과정을 거친다.

### 캡슐화 과정
- 갭슐화 과정은 상위 계층의 헤더와 데이터를 하위 계층의 데이터 부분에 포함시키고 
- 해당 계층의 헤더를 삽입하는 과정

