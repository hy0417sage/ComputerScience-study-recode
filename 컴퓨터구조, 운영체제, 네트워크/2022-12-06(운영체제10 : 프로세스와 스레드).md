# 프로세스
- 포그라운드 프로세스 : 사용자가 보는 앞어서 사용되는 프로세스
- 백그라운드 프로세스 : 사용자가 보지 못하는 뒷 편에서 실행되는 프로세스
    - 유닉스 체계의 운영체제에서는 **데몬**이라고 부르고
    - 윈도우 운영체제에서는 **서비스** 라고 부른다.

## 프로세스 제어 블록(PCB)
- 프로세스와 관련된 정보를 저장하는 자료 구조
- CPU 자원은 한정되어있어 프로세스들은 차례대로 돌아가며 한정된 시간 만큼만 CPU를 이용한다.
- 운영체제는 1, 2번을 위해 PCB를 사용합니다. 
    1. 프로세스 순서를 관리
    2. 프로세스에 CPU를 비롯한 자원을 배분
- 시간이 끝났음을 알리는 인터럽트 **타이머 인터럽트**가 발생하면 자기의 차례를 양보하고 다음 차례가 올때까지 기다린다.
    - 타이머 인터럽트 : 클럭 신호를 발생시키는 장치에 의해 주기적으로 발생하는 하드웨어 인터럽트 

### PCB에 담기는 정보
1. 프로세스 ID : 프로세스를 식별하기 위한 고유 번호
2. 레지스터 값
3. 프로세스 상태
4. CPU 스케줄링 정보
5. 메모리 관리 정보
6. 사용한 파일과 입출력장치 목록

## 문맥 교환 context switching
- 다른 프로세스로 실행 순서가 넘어가고 다시 돌아와 다시 실행을 재개 하려면 중간 정보를 백업해야 합니다.
    - **문맥 context** : 하나의 프로세스 수행을 재개하기 위해서 기억해야 하는 정보
- 기존 프로세스의 문맥을 PCB에 백업하고, 새로운 프로세스를 실행하기 위해 문맥을 PCB로부터 복구하여 새로운 프로세스를 실행하는 것을 문맥교환이라고 한다.  

# 🌟 프로세스의 메모리 영역
- 프로세스가 생성되면 커널 영역에 PCB가 생성된다. 그러면! **사용자 영역에는 프로세스가 어떻게 배치 될까?**
- 정적 할당 영역 : 영역의 크기가 변하지 않는 영역 (코드 영역, 데이터 영역)
- 동적 할당 영역 : 영역의 크기가 변하는 영역 (힙 영역, 스택 영역)

### 코드 영역
- 기계어로 이루어진 명령어가 저장
- CPU가 실행할 명령어가 담겨 있어 쓰기가 금지 되어있음

### 데이터 영역
- 프로그램이 실행되는 동안 유지할 데이터가 저장 되어있는 공간
- **전역 변수**가 대표적 : 프로그램이 실행되는 동안 유지되며, 프로그램 전체에서 접근할 수 있는 변수

### 힙 영역
- 프로그램을 만드는 사용자. 프로그래머가 직접 할당을 할 수 있는 저장 공간
- 프로그래밍 과정에서 힙 영역에 메모리를 할당 했을 시 언젠가는 해당 공간을 반환해야함
- 낮은 주소에서 높은 주소로 할당됨
- 반환하지 않는다면 **'메모리 누수'**가 발생한다.

### 스택 영역
- 데이터를 일시적으로 저장하는 공간
- 잠깐 쓰다가 말 값들이 저장된다.
- 높은 주소에서 낮은 주소로 할당됨
- **매개변수, 지역변수**가 대표적 : 일시적으로 사용할 데이터

# 프로세스의 상태와 계층 정보
## 프로세스 상태
- 프로세스들이 빠르게 번갈아 가면서 실행될 때 그 과정에서
- 하나의 프로세스는 여러 상태를 거치며 실행된다.

### 프로세스가 가지는 대표적인 상태와 프로세스 상태 다이어그램
1. 생성 상태 : 이제 막 메모리에 적재되어 PCB를 할당 받은 상태
2. 준비 상태 : 당장이라도 CPU를 할당받아 실행할 수 있지만, 아직 자신의 차례가 아니여서 기다리고 있는 상태
    - 준비 상태인 프로세스가 실행 상태로 전환되는 것을 "디스패치"라고 한다.
3. 실행 상태 : CPU를 실행 받아 실행 중인 상태 
    - 프로세스가 할당된 시간을 모두 사용한다면(타이머 인터럽트가 발생) 다시 준시 상태가 됨
4. 대기 상태 : 입출력장치의 작업을 기자리는 상태
5. 종료 상태 : 프로세스가 종료된 상태

## 프로세스 계층 구조
- 프로세스는 실행 도중 시스템 호출을 통해 다른 프로세스를 생성할 수 있다.
- 이때 새 프로젝트를 생성한 프로세스를 "부모 프로세스"
- 부모 프로세스에 의해 생성된 프로세스를 "자식 프로세스"라고 한다.
- 이 둘은 엄연히 다른 프로세스이므로 각기 다른 PID를 가지고 있다.
- 최초의 프로세스가 자식 프로세스를 생성하고, 생성된 자식 프로세스들이 새로운 프로세스를 낳는 형식으로 여러 프로세스가 동시에 실행

## 프로세스 생성 기법
- 부모 프로세스를 통해 생성된 자식들은 복제와 옷 갈아입기를 통해 실행 된다.
- 부모 프로세스는 fork를 통해 복사하여 자식 프로세스 생성
- 복사된 자식프로세스를 exec를 통해 자신의 메모리 공간을 다른 프로그램으로 교체
- 부모가 자식 프로세스를 실행하며 프로세스 계층 구조를 이루는 과정을 fork와 exec가 반복되는 과정이라 볼 수 있다.

# 스레드
- 스레드란 프로세스를 구성하는 실행 흐름의 단위
- 스레드를 이용하면 하나의 프로세스에서 여러 부분을 동시에 실행할 수 있음


## 프로세스와 스레드
- 단일 스레드 프로세스 : 실행의 흐름 단위가 하나
- 멀티 스레드 프로세스 : 하나의 프로세스가 여러 일을 동시에 처리할 수 있음
- 스레드는 프로세스 내에서 각기 다른 스레드ID, 프로그램 카운터 값, 레지스터 값, 스택으로 구성된다.
- 실행에 필요한 최소한의 정보만을 유지한 채 프로세스 자원을 공유하며 실행된다.

## 멀티 스레드와 멀티 프로세스
- 멀티 프로세스 : 여러 프로세스를 동시에 실행
- 멀티 스레드 : 여러 스레드로 프로세스를 동시에 실행
- (차이)프로세스끼리는 기본적으로 자원을 공유하지 않지만, 스레드끼리는 같은 프로세스 내의 자원을 공유한다.
- 스레드는 협력과 통신에 유리

### 프로세스간의 통신
- 프로세스간의 자원을 공유하고 데이터를 주고 받는 것을 프로세스 간의 통신(IPC)라고 부른다.
