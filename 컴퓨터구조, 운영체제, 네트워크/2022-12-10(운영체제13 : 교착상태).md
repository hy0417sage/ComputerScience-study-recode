# 교착상태
- 일어나지 않을 사전을 기다리며 진행이 멈춰 버리는 현상

### 식사하는 철학자 문제
- 교착상태는 어떻게 발생하는 가
- "식사하는 철학자 문제"가 가장 고전적이고 재미있는 교착상태 문제사항
- 철학자 n명이 각자 숫가락 이라는 자원만 점유한 채 자원의 사용이 끝나길 기다리는 상황

### 교착상태가 발생하는 상황
- 교착상태는 다양한 상황에서 발생한다.
- 앞서 배운 뮤텍스 락에서도 발생할 수 있음
- 이러한 교착상태가 발생했을떄의 상황을 그래프로 표현할 수 있음

### 자원 할당 그래프
- 교착상태는 자원 할당 그래프를 통해 단순하게 표현할 수 있다.
1. 프로세스는 원으로, 자원의 종류는 사각형으로 표현한다.
2. 사용할 수 있는 자원의 개수는 자원 사각형 내에 점으로 표현한다.
3. 프로세스가 어떤 자원을 할당받아 사용 중이라면 자원에서 프로세스를 향해 화살표를 표시한다.
4. 프로세스가 어떤 자원을 기다리고 있다면 프로세스에서 자원으로 화살표를 표시한다.
- 교착상태가 발생하면 자원 할당 그래프는 원의 형태를 띄우고 있다.

## 교착상태 발생 조건
1. 상호 배제 : 한 프로세스가 사용하는 자원을 다른 프로세스가 사용할 수 없을 때, 상호 배제 상황에서 교착상태가 발생한다.
2. 점유와 대기 : 자원을 할당받은 상태에서 다른 자원을 할당받기를 기다리는 상태
3. 비선점 : 어떤 프로세스도 다른 프로세스의 자원을 강제로 빼앗지 못했기 때문에 교착 상태가 발생
4. 원형 대기 : 프로세스들이 원의 형태로 자원을 대기하는 것을 원형대기라고 함.
- 이 4가지 조건이 다 만족 할 때 교착 상태가 발생할 가능성이 생긴다.

## 교착 상태 해결 방법
- 교착 상태를 해결하는 3가지 방법
1. 예방 : 교착상태를 예방하는 방법은 교착상태 필요조건 4가지 중 하나를 충족하지 못하게 하는 방법과 같다.
2. 회피
3. 검출후 회복

### 교착 상태 예방
1. 상호배제 없애기. 하지만, 현살적으로 모든 자원의 상호 배제를 없애기는 어려움이 있다.
    - 현실적으로 모든 자원의 상호 배제를 없애기는 어려움
2. 점유와 대기 없애기. 특정 프로세스에 자원을 모두 할당 하거나 아예 할당하지 않는 방식으로 배분한다.
    - 자원의 활용이 낮아질 우려가 있음
    - 점유와 대기를 금지하면 많은 자원을 사용하는 프로세스가 불리해짐
3. 비선점 조건을 없애기. 자원을 이용 중인 프로세스로부터 해당 자원을 빼앗을 수도 있다.
    - 다소 범용성이 떨어진다.
4. 원형 대기 조건을 없애보기. 모든 자원에 번호를 붙이고 오름차순으로 자원을 할당하면 원형 대기는 발생하지 않는다.
    - 앞의 세가지에 비하면 비교적 현실적이고 실용적인 방식이다.
    - 모든 컴퓨터 시스템 내에 존재하는 수많은 자원에 번호를 붙이는 일은 간단한 작업이 아니거니와 각 자원에 어떤 번호를 붙이는지에 따라 특정 자원의 활용률이 떨어질 수도 있다.

### 교착 상태 회피
- 교착 상태가 발생하지 않을 정도로만 조심조심 자원을 할당하는 방식
- 프로세스들에 할당할 수 있는 자원이 한정된 상태에서 모든 프로세스들이 한번에 많은 자원을 요구하면 교착상태가 발생할 위험이 증가한다.

#### 교착상태를 회피하는 방법 : 안전 상태, 불안정 상태, 안전 순서열
- 안전 상태 : 안전 순서대로 프로세스들에 자원을 배분하여 교착 상태가 발생하지 않고 모든 프로세스가 정상적으로 자원을 할당 받고 종료할 수 있는 상태
- 불안전 상태 : 안전 순서열이 없다. 교착 상태가 발생할 수도 있는 상황
- 안전 순서열 : 교착상태 없이 안전하게 프로세스들에 자원을 할당할 수 있는 순서

### 교착 상태 검출 후 회복
- 교착상태 예방과 회피는 교착상태 발생을 막기 위한 노력이었다면, 교착상태 검출 후 회복은 교착 상태 사실을 인정하고 사후에 조치하는 방식이다.

### 선점을 통한 회복
- 교착상태가 해결될 때까지 한 프로세스씩 자원을 몰아주는 방식
- 교착 상태가 해결될 때까지 한 프로세스씩 자원을 몰아주는 방식

### 프로세스 강제 종료를 통한 회복
- 프로세스 강제 종료를 통한 회복은 가장 단순하면서 확실한 방식!
1. 운영체제는 교착 상태가 없어질 때까지 한 프로세스씩 강제종료 할 수 있다.
2. 교착 상태가 없어질 떄까지 한 프로세스씩 강제 종료할 수 도 있다.
- (-) 가장 확실한 방식이지만, 그만큼 많은 프로세스들이 작업 내역을 잃게 될 가능성이 있고, 후자는 작업 내역을 잃는 프로세스는 최대한 즐일 수 있지만 교착 상태가 없어졌는지 여부를 확인하는 과정에서 오버헤드를 야기할 수 있다.

### 타조 알고리즘
- 교착상태를 아예 무시하는 방법
- 드물게 발생하는 잠재적 문제를 무시로 대처하는 방식
- 문제 발생의 빈도나 심각성에 따라 최대 효율을 추구하는 엔지니어 입장에서는 때때로 이 방식이 적합하다.